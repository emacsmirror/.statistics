:PREAMBLE:
#+TITLE: Epkgs: Issues
#+SETUPFILE: .orgconfig
#+NAME: setup
#+BEGIN_SRC emacs-lisp :results silent
  (require 'emir)
#+END_SRC
[[https://emacsmirror.net/stats][up]]
:END:
* Features provided by multiple packages
#+NAME: conflict
#+BEGIN_SRC emacs-lisp
  (let (alist)
    (dolist (name (epkgs 'name))
      (dolist (feature (epkg-sql [:select feature :from provided
                                  :where (and (= package $s1)
                                              (isnull drop))]
                                 name))
        (setq feature (car feature))
        (-if-let (elt (assq feature alist))
            (push name (cdr elt))
          (cl-pushnew (list feature name) alist))))
    (epkg-with-org-header ("Feature" "Package" "Shelved")
      (mapcar (-lambda ((feature package))
                (list feature package
                      (epkg-shelved-package-p (epkg package))))
              (-mapcat (-lambda ((feature . providers))
                         (and (> (length providers) 1)
                              (list (list feature providers))
                              (--map (list feature it)
                                     (sort providers #'string<))))
                       (cl-sort alist #'string< :key #'car)))))
#+END_SRC
#+RESULTS: conflict
| Feature (3)       | Package          | Shelved |
|-------------------+------------------+---------|
| inferior-picolisp | picolisp         |         |
| inferior-picolisp | picolisp-mode    |         |
| test-helper       | cpp-auto-include |         |
| test-helper       | mocha            |         |
| test-support      | buttercup-junit  |         |
| test-support      | ert-junit        |         |

- https://github.com/flexibeast/picolisp-mode/commit/d6083244
- buttercup-junit and [[https://bitbucket.org/olanilsson/ert-junit/issues/6][ert-junit#6]]

Reoccuring issues:
- test-helper (see [[https://github.com/rejeep/ert-runner.el/issues/38][ert-runner#38]])
  - https://github.com/syohex/emacs-cpp-auto-include/issues/6
  - https://github.com/scottaj/mocha.el/issues/62

* Packages with unsatisfied dependencies
#+NAME: unsatisfied
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class" "Feature" "Provider")
    (-mapcat
     (-lambda ((name class))
       (let (alist)
	 (-each (epkg-sql [:select feature :from required
                           :where (and (= package $s1)
                                       (isnull drop))]
                          name)
           (-lambda ((feature))
             (-if-let (provider (epkg-provided-by feature))
		 (when (epkg-sql [:select class :from packages
                                  :where (and (= name $s1)
                                              (= class 'shelved))]
				 provider)
                   (push (list feature provider) alist))
               (push (list feature nil) alist))))
	 (mapcar (-lambda ((feature provider))
                   (list name class feature provider))
		 (cl-sort alist #'string< :key #'car))))
     (epkgs [name class] 'epkg-mirrored-package--eieio-childp)))
#+END_SRC
#+RESULTS: unsatisfied
| Package (8)            | Class       | Feature                     | Provider |
|------------------------+-------------+-----------------------------+----------|
| bibeltex               | github      | org-bibtex                  |          |
| citeproc               | github      | org-bibtex                  |          |
| leaf                   | github      | alloc                       |          |
| leaf                   | github      | indent                      |          |
| leaf                   | github      | leaf-browser                |          |
| leaf                   | github      | leaf-polyfill               |          |
| leaf                   | github      | leaf-sub                    |          |
| leaf                   | github      | leaf-subsub                 |          |
| org-link-minor-mode    | github      | org-man                     |          |
| org-linkany            | github      | org-bbdb                    |          |
| org-mac-protocol       | github      | org-bibtex                  |          |
| org-ref                | github      | org-bibtex                  |          |
| wisitoken-grammar-mode | elpa-branch | wisitoken_grammar_1-process |          |

- https://github.com/ruediger/bibeltex/issues/2
- https://github.com/andras-simonyi/citeproc-el/issues/7
- https://github.com/conao3/leaf.el/issues/301
- https://github.com/seanohalpin/org-link-minor-mode/issues/7
- https://github.com/aki2o/org-linkany/issues/4
- https://github.com/claviclaws/org-mac-protocol/issues/8
- https://github.com/jkitchin/org-ref/issues/649
