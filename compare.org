:PREAMBLE:
#+TITLE: Epkgs: Overview
#+SETUPFILE: .orgconfig
#+NAME: setup
#+BEGIN_SRC emacs-lisp :results silent
  (require 'emir)
#+END_SRC
[[https://emacsmirror.net/stats][up]]
:END:
* Summary
#+NAME: summary
#+BEGIN_SRC emacs-lisp
  (require 'finder-inf)
  (let* ((builtin (read (car (process-lines
                              emir-emacs-reference "-Q" "--batch" "--eval"
                              "(progn (require 'finder-inf)
                                      (princ (length package--builtins)))"))))
         (builtin-emir (length (epkgs 'name 'epkg-builtin-package-p)))
         (builtin-elpa (length (epkg-sql [:select * :from gelpa-recipes
                                          :where class :in $v1]
                                         [core])))
         (gelpa        (length (epkg-sql [:select * :from gelpa-recipes
                                          :where class :in $v1
                                          :and (notnull released)]
                                         [external])))
         (shelved      (length (epkgs 'name 'epkg-shelved-package-p)))
         (table `(("" "Epkg" "Mirror" "Attic" "Emacs" "Gelpa" "Melpa")
                  hline
                  (builtin     ,builtin-emir 0 "" ,builtin ,builtin-elpa "")
                  (gnu-elpa    0  0  "" "" ,gelpa "")
                  hline
                  (github      0  0  "" "" "" 0)
                  (gitlab      0  0  "" "" "" 0)
                  (sourcehut   0  0  "" "" "" "")
                  (gnu         0  0  "" "" "" "")
                  (nongnu      0  0  "" "" "" "")
                  hline
                  (git         0  0  "" "" "" 0)
                  (subtree     0  0  "" "" "" "")
                  hline
                  (wiki        0  0  "" "" "" "")
                  (minority    0  0  "" "" "" "")
                  hline
                  (hg          0  0  "" "" "" 0)
                  (file        0  0  "" "" "" "")
                  hline
                  (orphaned    0  0  "" "" "" "")
                  (shelved     ,shelved "" ,shelved "" "" "")
                  hline)))
    (dolist (class (epkgs 'class 'epkg-mirrored-package--eieio-childp))
      (when (eq class 'core)
        (setq class 'builtin))
      (if-let ((elt (assq class table)))
          (progn
            (cl-incf (nth 1 elt))
            (cl-incf (nth 2 elt)))
        (error "No entry for %s" class)))
    (dolist (fetcher (epkg-sql [:select class :from melpa-recipes]))
      (cl-incf (nth 6 (assq (car fetcher) table))))
    ;; KLUDGE for org.  Avoid saying that this builtin package is
    ;; missing just because we mirror it from the upstream repo.
    ;; Also don't count it twice.
    (cl-incf (nth 1 (assq 'builtin table)))
    (cl-incf (nth 2 (assq 'builtin table)))
    (cl-decf (nth 1 (assq 'git table)))
    (cl-decf (nth 2 (assq 'git table)))
    `(,@table
      ("total"
       ,@(seq-reduce (lambda (acc elt)
                       (cl-mapcar (lambda (a b)
                                    (+ (if (numberp a) a 0)
                                       (if (numberp b) b 0)))
                                  acc elt))
                     (--keep (and (listp it)
                                  (symbolp (car it))
                                  (cdr it))
                             table)
                     '(0 0 0 0 0 0 0)))))
#+END_SRC
#+RESULTS: summary
|           | Epkg | Mirror | Attic | Emacs | Gelpa | Melpa |
|-----------+------+--------+-------+-------+-------+-------|
| builtin   |  466 |     15 |       |   467 |    15 |       |
| gnu-elpa  |  137 |    137 |       |       |   269 |       |
|-----------+------+--------+-------+-------+-------+-------|
| github    | 4927 |   4927 |       |       |       |  4710 |
| gitlab    |  166 |    166 |       |       |       |   162 |
| sourcehut |   34 |     34 |       |       |       |       |
| gnu       |    7 |      7 |       |       |       |       |
| nongnu    |    8 |      8 |       |       |       |       |
|-----------+------+--------+-------+-------+-------+-------|
| git       |   82 |     82 |       |       |       |   115 |
| subtree   |   25 |     25 |       |       |       |       |
|-----------+------+--------+-------+-------+-------+-------|
| wiki      |  590 |    590 |       |       |       |       |
| minority  |   18 |     18 |       |       |       |       |
|-----------+------+--------+-------+-------+-------+-------|
| hg        |   16 |     16 |       |       |       |    14 |
| file      |   55 |     55 |       |       |       |       |
|-----------+------+--------+-------+-------+-------+-------|
| orphaned  |  134 |    134 |       |       |       |       |
| shelved   | 1414 |        |  1414 |       |       |       |
|-----------+------+--------+-------+-------+-------+-------|
| total     | 8079 |   6214 |  1414 |   467 |   284 |  5001 |

* Emacs
** Prefer elpa
#+NAME: builtin-prefer-elpa
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class")
    (epkg-sql [:select :distinct [packages:name packages:class]
               :from [packages builtin-libraries]
               :where (= packages:name builtin-libraries:package)
               :and packages:class :in $v1
               :order-by [(asc packages:name)]]
              [gnu-elpa core]))
#+END_SRC
#+RESULTS: builtin-prefer-elpa
| Package (14) | Class |
|--------------+-------|
| cl-print     | core  |
| eldoc        | core  |
| flymake      | core  |
| jsonrpc      | core  |
| let-alist    | core  |
| map          | core  |
| ntlm         | core  |
| project      | core  |
| python       | core  |
| so-long      | core  |
| soap-client  | core  |
| svg          | core  |
| verilog-mode | core  |
| xref         | core  |

** Prefer upstream
#+NAME: builtin-prefer-upstream
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class")
    (epkg-sql [:select :distinct [packages:name packages:class]
               :from [packages builtin-libraries]
               :where (= packages:name builtin-libraries:package)
               :and packages:class :not :in $v1
               :order-by [(asc packages:name)]]
              [builtin gnu-elpa core]))
#+END_SRC
#+RESULTS: builtin-prefer-upstream
| Package (2) | Class |
|-------------+-------|
| org         | git   |
| tramp       | gnu   |

* Gelpa
** New
#+NAME: gelpa-new
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class" "Url")
    (seq-filter (pcase-lambda (`(,name ,class ,_url))
                  (and (not (assoc name emir-pending-packages))
                       (not (assoc name emir--preferred-builtins))
                       (not (assoc name emir-secondary-packages))
                       (or (not (eq class 'core))
                           (epkg-builtin-package-p (epkg name)))))
                (epkg-sql [:select [name class url]
                           :from gelpa-recipes
                           :where (or (isnull epkg-package)
                                      (= class 'core))
                           :order-by [(asc name)]])))
#+END_SRC
#+RESULTS: gelpa-new

** Pending
#+NAME: gelpa-pending
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Gelpa" "Reason")
    (-keep (pcase-lambda (`(,name ,class))
             (and-let* ((reason (cadr (assoc name emir-pending-packages))))
               (list name class reason)))
           (epkg-sql [:select [name class]
                      :from gelpa-recipes
                      :where (isnull epkg-package)
                      :order-by [(asc name)]])))
#+END_SRC
#+RESULTS: gelpa-pending

** Unreleased
#+NAME: gelpa-unreleased
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Gelpa")
    (epkg-sql [:select [name class]
               :from gelpa-recipes
               :where class :in $v1
               :and (isnull released)]
              [subtree external])))
#+END_SRC
#+RESULTS: gelpa-unreleased
| Package (5)      | Gelpa    |
|------------------+----------|
| sql-smie         | external |
| prefixed-core    | external |
| package-fixes    | external |
| shell-quasiquote | external |
| systemd          | external |

** Shelved
#+NAME: gelpa-shelved
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Gelpa")
    (epkg-sql [:select :distinct [packages:name gelpa-recipes:class]
               :from [packages gelpa-recipes]
               :where (= packages:name gelpa-recipes:name)
               :and (= packages:class 'shelved)
               :order-by [(asc packages:name)]]))
#+END_SRC
#+RESULTS: gelpa-shelved

** Prefer builtin
#+NAME: gelpa-prefer-builtin
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Gelpa" "Reason")
    (mapcar (pcase-lambda (`(,name ,class))
              (nconc (list name class)
                     (or (cdr (assoc name emir--preferred-builtins))
                         (list ""))))
            (epkg-sql [:select :distinct [packages:name gelpa-recipes:class]
                       :from [packages gelpa-recipes]
                       :where (= packages:name gelpa-recipes:name)
                       :and (= packages:class 'builtin)
                       :order-by [(asc packages:name)]])))
#+END_SRC
#+RESULTS: gelpa-prefer-builtin
| Package (4) | Gelpa    | Reason              |
|-------------+----------+---------------------|
| cl-generic  | external | backport of builtin |
| cl-lib      | external | backport of builtin |
| nadvice     | external | backport of builtin |
| seq         | external | backport of builtin |

** Prefer upstream
#+NAME: gelpa-prefer-upstream
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class" "Upst" "Elpa" "Link")
    (mapcar (pcase-lambda (`(,name ,class))
              (pcase-let ((`(,upstream ,gnu-elpa)
                           (with-emir-repository (epkg name)
                             (magit-rev-diff-count
                              "master"
                              (format "gnu-elpa/externals/%s" name)))))
                (list name class
                      (if (zerop upstream) "" upstream)
                      (if (zerop gnu-elpa) "" gnu-elpa)
                      (epkg-org-link name))))
            (epkg-sql [:select :distinct [packages:name packages:class]
                       :from [packages gelpa-recipes]
                       :where (= packages:name gelpa-recipes:epkg-package)
                       :and packages:class :not :in $v1
                       :and gelpa-recipes:class :not :in $v2
                       :order-by [(asc packages:name)]]
                      [builtin gnu-elpa shelved]
                      [core])))
#+END_SRC
#+RESULTS: gelpa-prefer-upstream
| Package (130)              | Class     | Upst | Elpa | Link                                |
|----------------------------+-----------+------+------+-------------------------------------|
| ace-window                 | github    |      |      | [[https://github.com/abo-abo/ace-window][abo-abo/ace-window]]                  |
| ack                        | github    |      |      | [[https://github.com/leoliu/ack-el][leoliu/ack-el]]                       |
| aggressive-indent          | github    |      |      | [[https://github.com/Malabarba/aggressive-indent-mode][Malabarba/aggressive-indent-mode]]    |
| ahungry-theme              | github    |      |      | [[https://github.com/ahungry/color-theme-ahungry][ahungry/color-theme-ahungry]]         |
| async                      | github    |      |      | [[https://github.com/jwiegley/emacs-async][jwiegley/emacs-async]]                |
| auctex                     | gnu       |    7 |  195 | [[https://savannah.gnu.org/projects/auctex][gnu:auctex]]                          |
| avy                        | github    |   25 |    5 | [[https://github.com/abo-abo/avy][abo-abo/avy]]                         |
| bbdb                       | nongnu    |   27 |   24 | [[http://bbdb.sourceforge.net][nongnu:bbdb]]                         |
| beacon                     | github    |      |      | [[https://github.com/Malabarba/beacon][Malabarba/beacon]]                    |
| bnf-mode                   | github    |      |      | [[https://github.com/sergeyklay/bnf-mode][sergeyklay/bnf-mode]]                 |
| buffer-expose              | github    |      |      | [[https://github.com/clemera/buffer-expose][clemera/buffer-expose]]               |
| bug-hunter                 | github    |    1 |    2 | [[https://github.com/Malabarba/elisp-bug-hunter][Malabarba/elisp-bug-hunter]]          |
| cobol-mode                 | git       |      |    9 |                                     |
| coffee-mode                | github    |  483 |    3 | [[https://github.com/defunkt/coffee-mode][defunkt/coffee-mode]]                 |
| compact-docstrings         | github    |      |    1 | [[https://github.com/cpitclaudel/compact-docstrings][cpitclaudel/compact-docstrings]]      |
| company                    | github    |    2 |      | [[https://github.com/company-mode/company-mode][company-mode/company-mode]]           |
| company-math               | github    |    1 |      | [[https://github.com/vspinu/company-math][vspinu/company-math]]                 |
| company-statistics         | github    |      |      | [[https://github.com/company-mode/company-statistics][company-mode/company-statistics]]     |
| consult                    | github    |      |      | [[https://github.com/minad/consult][minad/consult]]                       |
| context-coloring           | github    |    1 |    1 | [[https://github.com/jacksonrayhamilton/context-coloring][jacksonrayhamilton/context-coloring]] |
| corfu                      | github    |      |      | [[https://github.com/minad/corfu][minad/corfu]]                         |
| cpio-mode                  | github    |      |    4 | [[https://github.com/dlewan/cpio-mode][dlewan/cpio-mode]]                    |
| csharp-mode                | github    |    3 |      | [[https://github.com/emacs-csharp/csharp-mode][emacs-csharp/csharp-mode]]            |
| darkroom                   | github    |      |      | [[https://github.com/joaotavora/darkroom][joaotavora/darkroom]]                 |
| dash                       | github    |      |      | [[https://github.com/magnars/dash.el][magnars/dash.el]]                     |
| dbus-codegen               | github    |      |    3 | [[https://github.com/ueno/dbus-codegen-el][ueno/dbus-codegen-el]]                |
| delight                    | nongnu    |      |      | [[https://savannah.nongnu.org/projects/delight][nongnu:delight]]                      |
| devdocs                    | github    |      |      | [[https://github.com/astoff/devdocs.el][astoff/devdocs.el]]                   |
| diff-hl                    | github    |      |      | [[https://github.com/dgutov/diff-hl][dgutov/diff-hl]]                      |
| diffview                   | github    |      |    2 | [[https://github.com/mgalgs/diffview-mode][mgalgs/diffview-mode]]                |
| dired-git-info             | github    |      |      | [[https://github.com/clemera/dired-git-info][clemera/dired-git-info]]              |
| disk-usage                 | gitlab    |      |      | [[https://gitlab.com/ambrevar/emacs-disk-usage][ambrevar/emacs-disk-usage]]           |
| dts-mode                   | github    |      |    7 | [[https://github.com/bgamari/dts-mode][bgamari/dts-mode]]                    |
| easy-kill                  | github    |      |      | [[https://github.com/leoliu/easy-kill][leoliu/easy-kill]]                    |
| eev                        | github    |      |      | [[https://github.com/edrx/eev][edrx/eev]]                            |
| eglot                      | github    |   13 |      | [[https://github.com/joaotavora/eglot][joaotavora/eglot]]                    |
| eldoc-eval                 | github    |   27 |    1 | [[https://github.com/thierryvolpiatto/eldoc-eval][thierryvolpiatto/eldoc-eval]]         |
| electric-spacing           | github    |  119 |    5 | [[https://github.com/xwl/electric-spacing][xwl/electric-spacing]]                |
| emms                       | gnu       |      |      | [[http://www.gnu.org/software/emms][gnu:emms]]                            |
| enwc                       | hg        |      |      | [[https://savannah.nongnu.org/p/enwc]]  |
| ergoemacs-mode             | github    |      |      | [[https://github.com/ergoemacs/ergoemacs-mode][ergoemacs/ergoemacs-mode]]            |
| expand-region              | github    |   18 |    1 | [[https://github.com/magnars/expand-region.el][magnars/expand-region.el]]            |
| exwm                       | github    |      |      | [[https://github.com/ch11ng/exwm][ch11ng/exwm]]                         |
| flymake-proselint          | github    |      |      | [[https://github.com/manuel-uberti/flymake-proselint][manuel-uberti/flymake-proselint]]     |
| frog-menu                  | github    |      |      | [[https://github.com/clemera/frog-menu][clemera/frog-menu]]                   |
| ftable                     | github    |      |      | [[https://github.com/casouri/ftable][casouri/ftable]]                      |
| gcmh                       | gitlab    |      |      | [[https://gitlab.com/koral/gcmh][koral/gcmh]]                          |
| ggtags                     | github    |      |      | [[https://github.com/leoliu/ggtags][leoliu/ggtags]]                       |
| gnome-c-style              | github    |      |      | [[https://github.com/ueno/gnome-c-style][ueno/gnome-c-style]]                  |
| gpastel                    | github    |      |      | [[https://github.com/DamienCassou/gpastel][DamienCassou/gpastel]]                |
| greader                    | gitlab    |      |      | [[https://gitlab.com/michelangelo-rodriguez/greader][michelangelo-rodriguez/greader]]      |
| guess-language             | github    |   30 |    3 | [[https://github.com/tmalsburg/guess-language.el][tmalsburg/guess-language.el]]         |
| hiddenquote                | gitlab    |      |      | [[https://gitlab.com/mauroaranda/hiddenquote/hiddenquote][mauroaranda/hiddenquote/hiddenquote]] |
| highlight-escape-sequences | github    |      |      | [[https://github.com/dgutov/highlight-escape-sequences][dgutov/highlight-escape-sequences]]   |
| hook-helpers               | nongnu    |      |    1 | [[https://savannah.nongnu.org/projects/hook-helpers-el][nongnu:hook-helpers]]                 |
| hydra                      | github    |   75 |    2 | [[https://github.com/abo-abo/hydra][abo-abo/hydra]]                       |
| hyperbole                  | gnu       |      |      | [[http://www.gnu.org/software/hyperbole][gnu:hyperbole]]                       |
| isearch-mb                 | github    |      |      | [[https://github.com/astoff/isearch-mb][astoff/isearch-mb]]                   |
| ivy                        | github    |    1 |   23 | [[https://github.com/abo-abo/swiper][abo-abo/swiper]]                      |
| ivy-explorer               | github    |      |      | [[https://github.com/clemera/ivy-explorer][clemera/ivy-explorer]]                |
| ivy-posframe               | github    |      |      | [[https://github.com/tumashu/ivy-posframe][tumashu/ivy-posframe]]                |
| js2-mode                   | github    |      |      | [[https://github.com/mooz/js2-mode][mooz/js2-mode]]                       |
| json-mode                  | github    |   77 |    6 | [[https://github.com/joshwnj/json-mode][joshwnj/json-mode]]                   |
| kiwix                      | github    |      |      | [[https://github.com/stardiviner/kiwix.el][stardiviner/kiwix.el]]                |
| leaf                       | github    |      |      | [[https://github.com/conao3/leaf.el][conao3/leaf.el]]                      |
| load-relative              | github    |   13 |    7 | [[https://github.com/rocky/emacs-load-relative][rocky/emacs-load-relative]]           |
| loc-changes                | github    |    3 |    1 | [[https://github.com/rocky/emacs-loc-changes][rocky/emacs-loc-changes]]             |
| loccur                     | github    |   12 |    2 | [[https://github.com/fourier/loccur][fourier/loccur]]                      |
| marginalia                 | github    |      |      | [[https://github.com/minad/marginalia][minad/marginalia]]                    |
| math-symbol-lists          | github    |    2 |    2 | [[https://github.com/vspinu/math-symbol-lists][vspinu/math-symbol-lists]]            |
| mines                      | github    |      |    8 | [[https://github.com/calancha/Minesweeper][calancha/Minesweeper]]                |
| mmm-mode                   | github    |      |      | [[https://github.com/purcell/mmm-mode][purcell/mmm-mode]]                    |
| multishell                 | github    |      |      | [[https://github.com/kenmanheimer/EmacsMultishell][kenmanheimer/EmacsMultishell]]        |
| muse                       | github    |    9 |   11 | [[https://github.com/alexott/muse][alexott/muse]]                        |
| nameless                   | github    |      |      | [[https://github.com/Malabarba/Nameless][Malabarba/Nameless]]                  |
| names                      | github    |      |    2 | [[https://github.com/Malabarba/names][Malabarba/names]]                     |
| ob-haxe                    | github    |      |      | [[https://github.com/ianxm/ob-haxe.el][ianxm/ob-haxe.el]]                    |
| objed                      | github    |      |      | [[https://github.com/clemera/objed][clemera/objed]]                       |
| on-screen                  | github    |      |    2 | [[https://github.com/michael-heerdegen/on-screen.el][michael-heerdegen/on-screen.el]]      |
| org                        | git       |    2 |      | [[https://orgmode.org]]                 |
| pabbrev                    | github    |      |      | [[https://github.com/phillord/pabbrev][phillord/pabbrev]]                    |
| parsec                     | github    |      |      | [[https://github.com/cute-jumper/parsec.el][cute-jumper/parsec.el]]               |
| pinentry                   | github    |      |      | [[https://github.com/ueno/pinentry-el][ueno/pinentry-el]]                    |
| posframe                   | github    |      |      | [[https://github.com/tumashu/posframe][tumashu/posframe]]                    |
| pyim                       | github    |      |      | [[https://github.com/tumashu/pyim][tumashu/pyim]]                        |
| pyim-basedict              | github    |      |      | [[https://github.com/tumashu/pyim-basedict][tumashu/pyim-basedict]]               |
| realgud                    | github    |      |      | [[https://github.com/realgud/realgud][realgud/realgud]]                     |
| realgud-ipdb               | github    |      |      | [[https://github.com/realgud/realgud-ipdb][realgud/realgud-ipdb]]                |
| realgud-jdb                | github    |      |      | [[https://github.com/realgud/realgud-jdb][realgud/realgud-jdb]]                 |
| realgud-lldb               | github    |      |      | [[https://github.com/realgud/realgud-lldb][realgud/realgud-lldb]]                |
| realgud-node-debug         | github    |      |      | [[https://github.com/realgud/realgud-node-debug][realgud/realgud-node-debug]]          |
| realgud-node-inspect       | github    |      |      | [[https://github.com/realgud/realgud-node-inspect][realgud/realgud-node-inspect]]        |
| realgud-trepan-ni          | github    |      |      | [[https://github.com/realgud/realgud-trepan-ni][realgud/realgud-trepan-ni]]           |
| rec-mode                   | gnu       |      |      | [[https://www.gnu.org/software/recutils][gnu:rec-mode]]                        |
| relint                     | github    |      |      | [[https://github.com/mattiase/relint][mattiase/relint]]                     |
| rich-minority              | github    |      |      | [[https://github.com/Malabarba/rich-minority][Malabarba/rich-minority]]             |
| rt-liberation              | nongnu    |      |      | [[http://www.nongnu.org/rtliber][nongnu:rt-liberation]]                |
| scanner                    | gitlab    |      |      | [[https://gitlab.com/rstocker/scanner][rstocker/scanner]]                    |
| shell-command+             | sourcehut |      |   11 | [[https://git.sr.ht/~zge/bang][zge/bang]]                            |
| slime-volleyball           | github    |   31 |   59 | [[https://github.com/fitzsim/slime-volleyball][fitzsim/slime-volleyball]]            |
| smalltalk-mode             | nongnu    | 2332 |   57 | [[https://savannah.nongnu.org/projects/smalltalk-mode][nongnu:smalltalk-mode]]               |
| sotlisp                    | github    |      |      | [[https://github.com/Malabarba/speed-of-thought-lisp][Malabarba/speed-of-thought-lisp]]     |
| spinner                    | github    |      |      | [[https://github.com/Malabarba/spinner.el][Malabarba/spinner.el]]                |
| sql-indent                 | github    |   15 |  145 | [[https://github.com/bsvingen/sql-indent][bsvingen/sql-indent]]                 |
| ssh-deploy                 | github    |      |      | [[https://github.com/cjohansson/emacs-ssh-deploy][cjohansson/emacs-ssh-deploy]]         |
| system-packages            | gitlab    |      |      | [[https://gitlab.com/jabranham/system-packages][jabranham/system-packages]]           |
| systemd                    | github    |  131 |    4 | [[https://github.com/holomorph/systemd-mode][holomorph/systemd-mode]]              |
| temp-buffer-browse         | github    |      |      | [[https://github.com/leoliu/temp-buffer-browse][leoliu/temp-buffer-browse]]           |
| test-simple                | github    |      |      | [[https://github.com/rocky/emacs-test-simple][rocky/emacs-test-simple]]             |
| tiny                       | github    |      |      | [[https://github.com/abo-abo/tiny][abo-abo/tiny]]                        |
| tramp                      | gnu       | 4435 |   49 | [[https://savannah.gnu.org/projects/tramp][gnu:tramp]]                           |
| transient                  | github    |      |      | [[https://github.com/magit/transient][magit/transient]]                     |
| undo-tree                  | gitlab    |    7 |    1 | [[https://gitlab.com/tsc25/undo-tree][tsc25/undo-tree]]                     |
| validate                   | github    |      |      | [[https://github.com/Malabarba/validate.el][Malabarba/validate.el]]               |
| valign                     | github    |      |      | [[https://github.com/casouri/valign][casouri/valign]]                      |
| vc-hgcmd                   | github    |      |      | [[https://github.com/muffinmad/emacs-vc-hgcmd][muffinmad/emacs-vc-hgcmd]]            |
| vdiff                      | github    |      |      | [[https://github.com/justbur/emacs-vdiff][justbur/emacs-vdiff]]                 |
| vertico                    | github    |      |      | [[https://github.com/minad/vertico][minad/vertico]]                       |
| vlf                        | github    |      |    5 | [[https://github.com/m00natic/vlfi][m00natic/vlfi]]                       |
| wcheck-mode                | github    |      |      | [[https://github.com/tlikonen/wcheck-mode][tlikonen/wcheck-mode]]                |
| wconf                      | github    |      |      | [[https://github.com/ilohmar/wconf][ilohmar/wconf]]                       |
| web-server                 | github    |      |    8 | [[https://github.com/eschulte/emacs-web-server][eschulte/emacs-web-server]]           |
| webfeeder                  | gitlab    |      |      | [[https://gitlab.com/ambrevar/emacs-webfeeder][ambrevar/emacs-webfeeder]]            |
| websocket                  | github    |  109 |   18 | [[https://github.com/ahyatt/emacs-websocket][ahyatt/emacs-websocket]]              |
| which-key                  | github    |      |      | [[https://github.com/justbur/emacs-which-key][justbur/emacs-which-key]]             |
| windower                   | gitlab    |      |      | [[https://gitlab.com/ambrevar/emacs-windower][ambrevar/emacs-windower]]             |
| xelb                       | github    |      |      | [[https://github.com/ch11ng/xelb][ch11ng/xelb]]                         |
| xr                         | github    |      |      | [[https://github.com/mattiase/xr][mattiase/xr]]                         |
| yasnippet                  | github    |      |    1 | [[https://github.com/joaotavora/yasnippet][joaotavora/yasnippet]]                |
| ztree                      | github    |      |      | [[https://github.com/fourier/ztree][fourier/ztree]]                       |

** Prefer Elpa despite :url
#+NAME: gelpa-prefer-gelpa
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" ":url")
    (let ((alist (emir-gelpa--package-alist)))
      (-keep (pcase-lambda (`(,name ,_class ,_gelpa))
               (and-let* ((url (plist-get (cdr (assoc name alist)) :url)))
                 (list name url)))
             (epkg-sql [:select :distinct [packages:name
                                           packages:class
                                           gelpa-recipes:class]
                        :from [packages gelpa-recipes]
                        :where (= packages:name gelpa-recipes:epkg-package)
                        :and packages:class :in $v1
                        :order-by [(asc gelpa-recipes:url)
                                   (asc packages:name)]]
                       [gnu-elpa]))))
#+END_SRC
#+RESULTS: gelpa-prefer-gelpa
| Package (17)        | :url                                              |
|---------------------+---------------------------------------------------|
| paced               | bzr::bzr://bzr.savannah.nongnu.org/paced-el/trunk |
| org-edna            | bzr::https://bzr.savannah.gnu.org/r/org-edna-el   |
| vcl-mode            | git://git.gnu.org.ua/vcl-mode                     |
| auto-overlays       | http://www.dr-qubit.org/git/predictive.git        |
| dict-tree           | http://www.dr-qubit.org/git/predictive.git        |
| heap                | http://www.dr-qubit.org/git/predictive.git        |
| queue               | http://www.dr-qubit.org/git/predictive.git        |
| tNFA                | http://www.dr-qubit.org/git/predictive.git        |
| trie                | http://www.dr-qubit.org/git/predictive.git        |
| setup               | https://git.sr.ht/~pkal/setup                     |
| phps-mode           | https://github.com/cjohansson/emacs-phps-mode     |
| clipboard-collector | https://github.com/clemera/clipboard-collector    |
| ebdb                | https://github.com/girzel/ebdb.git                |
| psgml               | https://github.com/lenst/psgml.git                |
| ioccur              | https://github.com/thierryvolpiatto/ioccur.git    |
| persist             | https://gitlab.com/phillord/persist.git           |
| bluetooth           | https://gitlab.com/rstocker/emacs-bluetooth       |

* Melpa
** New
#+NAME: melpa-new
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Class" "Melpa" "Link")
    (-keep (pcase-lambda (`(,name ,fetcher ,url))
             (and (not (assoc name emir-pending-packages))
                  (not (or (emir--lookup-url url)
                           (cadr (assoc name emir-secondary-packages))))
                  (list name
                        (emir--url-to-class url)
                        fetcher
                        (melpa-org-link name))))
           (epkg-sql [:select [name class url]
                      :from melpa-recipes
                      :where (isnull epkg-package)
                      :order-by [(asc url)
                                 (asc name)]])))
#+END_SRC
#+RESULTS: melpa-new

** Pending
#+NAME: melpa-pending
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Melpa" "Reason")
    (-keep (pcase-lambda (`(,name ,class))
             (and-let* ((reason (cadr (assoc name emir-pending-packages))))
               (list name class reason)))
           (epkg-sql [:select [name class]
                      :from melpa-recipes
                      :where (isnull epkg-package)
                      :order-by [(asc name)]])))
#+END_SRC
#+RESULTS: melpa-pending

** Shared repositories
#+NAME: secondary-packages
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Primary package" "Secondary package" "Class")
    (epkg-sql [:select :distinct [packages:name
                                  melpa-recipes:name
                                  packages:class]
               :from [packages melpa-recipes]
               :where (= packages:name melpa-recipes:epkg-package)
               :and :not (= melpa-recipes:epkg-package
                            melpa-recipes:name)
               :order-by [(asc packages:name)
                          (asc melpa-recipes:name)]]))
#+END_SRC
#+RESULTS: secondary-packages
| Primary package (122)   | Secondary package                 | Class     |
|-------------------------+-----------------------------------+-----------|
| 750words                | ox-750words                       | github    |
| ac-php                  | ac-php-core                       | github    |
| ac-php                  | company-php                       | github    |
| agda2-mode              | annotation                        | subtree   |
| agda2-mode              | eri                               | subtree   |
| ameba                   | flycheck-ameba                    | github    |
| axiom-environment       | company-axiom                     | git       |
| axiom-environment       | ob-axiom                          | git       |
| biblio                  | biblio-core                       | github    |
| bibtex-completion       | helm-bibtex                       | github    |
| bibtex-completion       | ivy-bibtex                        | github    |
| bufler                  | helm-bufler                       | github    |
| button-lock             | wiki-nav                          | github    |
| calfw                   | calfw-cal                         | github    |
| calfw                   | calfw-howm                        | github    |
| calfw                   | calfw-ical                        | github    |
| calfw                   | calfw-org                         | github    |
| cfn-mode                | flycheck-cfn                      | gitlab    |
| chronometrist           | chronometrist-key-values          | git       |
| chumpy-windows          | spaces                            | github    |
| chumpy-windows          | splitter                          | github    |
| chumpy-windows          | window-jump                       | github    |
| circe                   | tracking                          | github    |
| clojure-essential-ref   | clojure-essential-ref-nov         | github    |
| clojure-mode            | clojure-mode-extra-font-locking   | github    |
| codesearch              | projectile-codesearch             | github    |
| colorless-themes        | lavenderless-theme                | sourcehut |
| colorless-themes        | nordless-theme                    | sourcehut |
| copyit                  | copyit-pandoc                     | github    |
| crystal-mode            | flycheck-crystal                  | github    |
| ctl-mode                | gs-mode                           | github    |
| dash                    | dash-functional                   | github    |
| datetime-format         | timecop                           | github    |
| ddskk                   | ccc                               | github    |
| ddskk                   | cdb                               | github    |
| deferred                | concurrent                        | github    |
| dictionary              | connection                        | github    |
| dictionary              | link                              | github    |
| dired-hacks             | dired-avfs                        | github    |
| dired-hacks             | dired-collapse                    | github    |
| dired-hacks             | dired-filter                      | github    |
| dired-hacks             | dired-hacks-utils                 | github    |
| dired-hacks             | dired-narrow                      | github    |
| dired-hacks             | dired-open                        | github    |
| dired-hacks             | dired-rainbow                     | github    |
| dired-hacks             | dired-ranger                      | github    |
| dired-hacks             | dired-subtree                     | github    |
| distel-completion-lib   | auto-complete-distel              | github    |
| distel-completion-lib   | company-distel                    | github    |
| dix                     | dix-evil                          | github    |
| django-mode             | django-snippets                   | github    |
| dogears                 | helm-dogears                      | github    |
| dylan                   | dime                              | github    |
| eclim                   | ac-emacs-eclim                    | github    |
| eclim                   | company-emacs-eclim               | github    |
| elfeed                  | elfeed-web                        | github    |
| emacsql                 | emacsql-mysql                     | github    |
| emacsql                 | emacsql-psql                      | github    |
| emacsql                 | emacsql-sqlite                    | github    |
| embark                  | avy-embark-collect                | github    |
| embark                  | embark-consult                    | github    |
| espotify                | consult-spotify                   | git       |
| espotify                | ivy-spotify                       | git       |
| esqlite                 | esqlite-helm                      | github    |
| evil                    | evil-test-helpers                 | github    |
| ewal                    | ewal-doom-themes                  | github    |
| ewal                    | ewal-evil-cursors                 | github    |
| ewal                    | ewal-spacemacs-themes             | github    |
| flutter                 | flutter-l10n-flycheck             | github    |
| flx                     | flx-ido                           | github    |
| flycheck-aspell         | flymake-aspell                    | github    |
| flyspell-correct        | flyspell-correct-avy-menu         | github    |
| flyspell-correct        | flyspell-correct-helm             | github    |
| flyspell-correct        | flyspell-correct-ivy              | github    |
| flyspell-correct        | flyspell-correct-popup            | github    |
| friendly-shell          | friendly-remote-shell             | github    |
| friendly-shell          | friendly-shell-command            | github    |
| fsharp-mode             | eglot-fsharp                      | github    |
| fuz                     | helm-fuz                          | github    |
| git-emacs               | git-blamed                        | github    |
| git-modes               | gitattributes-mode                | github    |
| git-modes               | gitconfig-mode                    | github    |
| git-modes               | gitignore-mode                    | github    |
| gitlab                  | helm-gitlab                       | github    |
| gitlab                  | ivy-gitlab                        | github    |
| go-mode                 | go-guru                           | github    |
| go-mode                 | go-rename                         | github    |
| groovy-mode             | grails-mode                       | github    |
| haskell-emacs           | haskell-emacs-base                | github    |
| haskell-emacs           | haskell-emacs-text                | github    |
| helm                    | helm-core                         | github    |
| historian               | ivy-historian                     | github    |
| hydra                   | lv                                | github    |
| indent-lint             | flycheck-indent                   | github    |
| ivy                     | counsel                           | github    |
| ivy                     | ivy-avy                           | github    |
| ivy                     | ivy-hydra                         | github    |
| ivy                     | swiper                            | github    |
| jade-mode               | stylus-mode                       | github    |
| jade-mode               | sws-mode                          | github    |
| jedi                    | jedi-core                         | github    |
| jump                    | inflections                       | github    |
| kaesar                  | kaesar-file                       | github    |
| kaesar                  | kaesar-mode                       | github    |
| kaleidoscope            | kaleidoscope-evil-state-flash     | github    |
| keg                     | flycheck-keg                      | github    |
| keg                     | keg-mode                          | github    |
| kubel                   | kubel-evil                        | github    |
| kubernetes              | kubernetes-evil                   | github    |
| lean-mode               | company-lean                      | github    |
| lean-mode               | helm-lean                         | github    |
| load-theme-buffer-local | color-theme-buffer-local          | github    |
| loopy                   | loopy-dash                        | github    |
| mac-pseudo-daemon       | osx-pseudo-daemon                 | github    |
| magit                   | git-commit                        | github    |
| magit                   | magit-libgit                      | github    |
| magit                   | magit-section                     | github    |
| major-mode-hydra        | pretty-hydra                      | github    |
| maxima                  | company-maxima                    | gitlab    |
| merlin                  | merlin-ac                         | subtree   |
| merlin                  | merlin-company                    | subtree   |
| merlin                  | merlin-iedit                      | subtree   |
| metal-archives          | metal-archives-shopping-list      | github    |
| nameframe               | nameframe-perspective             | github    |
| nameframe               | nameframe-projectile              | github    |
| nand2tetris             | company-nand2tetris               | github    |
| nand2tetris             | nand2tetris-assembler             | github    |
| native-complete         | company-native-complete           | github    |
| nixos-options           | company-nixos-options             | github    |
| nixos-options           | helm-nixos-options                | github    |
| nixos-options           | nix-sandbox                       | github    |
| opener                  | evil-opener                       | github    |
| org-multi-wiki          | helm-org-multi-wiki               | github    |
| org-pdftools            | org-noter-pdftools                | github    |
| org-projectile          | org-category-capture              | github    |
| org-projectile          | org-projectile-helm               | github    |
| org-ql                  | helm-org-ql                       | github    |
| org-recent-headings     | helm-org-recent-headings          | github    |
| org-starter             | org-starter-swiper                | github    |
| org2blog                | metaweblog                        | github    |
| ox-twiki                | ox-tiddly                         | github    |
| package-lint            | package-lint-flymake              | github    |
| pest-mode               | flycheck-pest                     | github    |
| pest-mode               | flymake-pest                      | github    |
| phpactor                | company-phpactor                  | github    |
| phpstan                 | flycheck-phpstan                  | github    |
| phpstan                 | flymake-phpstan                   | github    |
| pig-mode                | pig-snippets                      | github    |
| pollen-mode             | company-pollen                    | github    |
| prescient               | company-prescient                 | github    |
| prescient               | ivy-prescient                     | github    |
| prescient               | selectrum-prescient               | github    |
| processing-mode         | processing-snippets               | github    |
| prosjekt                | dirtree-prosjekt                  | github    |
| prosjekt                | helm-prosjekt                     | github    |
| psalm                   | flycheck-psalm                    | github    |
| request                 | request-deferred                  | github    |
| restclient              | restclient-helm                   | github    |
| rinari                  | ruby-compilation                  | github    |
| ripgrep                 | projectile-ripgrep                | github    |
| rtags                   | ac-rtags                          | github    |
| rtags                   | company-rtags                     | github    |
| rtags                   | flycheck-rtags                    | github    |
| rtags                   | helm-rtags                        | github    |
| rtags                   | ivy-rtags                         | github    |
| rtags                   | rtags-xref                        | github    |
| semaphore               | semaphore-promise                 | github    |
| sift                    | projectile-sift                   | github    |
| smart-mode-line         | smart-mode-line-powerline-theme   | github    |
| solidity-mode           | company-solidity                  | github    |
| solidity-mode           | solidity-flycheck                 | github    |
| sourcekit               | company-sourcekit                 | github    |
| speechd                 | speechd-el                        | github    |
| springboard             | ido-springboard                   | github    |
| stan-mode               | company-stan                      | github    |
| stan-mode               | eldoc-stan                        | github    |
| stan-mode               | flycheck-stan                     | github    |
| stan-mode               | stan-snippets                     | github    |
| term-manager            | term-projectile                   | github    |
| tern                    | tern-auto-complete                | github    |
| tree-sitter             | tsc                               | github    |
| treemacs                | treemacs-all-the-icons            | github    |
| treemacs                | treemacs-evil                     | github    |
| treemacs                | treemacs-icons-dired              | github    |
| treemacs                | treemacs-magit                    | github    |
| treemacs                | treemacs-persp                    | github    |
| treemacs                | treemacs-perspective              | github    |
| treemacs                | treemacs-projectile               | github    |
| use-package             | bind-chord                        | github    |
| use-package             | bind-key                          | github    |
| use-package             | use-package-chords                | github    |
| use-package             | use-package-ensure-system-package | github    |
| vdm-mode                | flycheck-vdm                      | github    |
| vdm-mode                | vdm-comint                        | github    |
| vdm-mode                | vdm-snippets                      | github    |
| w3m                     | shimbun                           | github    |
| wgrep                   | wgrep-ack                         | github    |
| wgrep                   | wgrep-ag                          | github    |
| wgrep                   | wgrep-helm                        | github    |
| wgrep                   | wgrep-pt                          | github    |
| xwwp                    | xwwp-follow-link-helm             | github    |
| xwwp                    | xwwp-follow-link-ivy              | github    |
| ycm                     | company-ycm                       | github    |
| ycmd                    | company-ycmd                      | github    |
| ycmd                    | flycheck-ycmd                     | github    |

** Diverging repositories
#+NAME: melpa-diverging-repositories
#+BEGIN_SRC emacs-lisp
  (epkg-with-org-header ("Package" "Mirror" "Melpa")
    (-keep
     (pcase-lambda (`(,name ,type ,url ,murl))
       (and
        (not (or (and (string-prefix-p "hg::" url)
                      (equal murl (substring url 4)))
                 (string-prefix-p "git@github.com:emacsmirror/" murl)
                 (string-prefix-p "git@github.com:emacsattic/"  murl)
                 (equal
                  (if (string-suffix-p ".git"  url) (substring  url 0 -4)  url)
                  (if (string-suffix-p ".git" murl) (substring murl 0 -4) murl))))
        (list name
              (epkg-org-link  name)
              (melpa-org-link name))))
     (epkg-sql [:select :distinct [packages:name packages:class
                                   packages:url melpa-recipes:url]
                :from [packages melpa-recipes]
                :where    (= melpa-recipes:epkg-package packages:name)
                :and      (= melpa-recipes:epkg-package melpa-recipes:name)
                :and :not (= packages:url melpa-recipes:url)
                :and :not (= packages:class 'minority)
                :and :not (= packages:class 'subtree)
                :and :not (= packages:class 'builtin)
                :and :not (= packages:class 'gnu-elpa)
                :and :not (= packages:class 'wiki)
                :order-by [(asc packages:name)]])))
#+END_SRC
#+RESULTS: melpa-diverging-repositories
| Package (5)    | Mirror                                   | Melpa                                  |
|----------------+------------------------------------------+----------------------------------------|
| 0x0            | [[https://git.sr.ht/~zge/nullpointer-emacs]] | [[https://gitlab.com/willvaughn/emacs-0x0][willvaughn/emacs-0x0]]                   |
| autocrypt      | [[https://git.sr.ht/~zge/autocrypt]]         | https://git.sr.ht/~pkal/autocrypt      |
| clang-capf     | [[https://git.sr.ht/~zge/clang-capf]]        | https://git.sr.ht/~pkal/clang-capf     |
| face-shift     | [[https://git.sr.ht/~zge/face-shift]]        | https://git.sr.ht/~pkal/face-shift     |
| insert-kaomoji | [[https://git.sr.ht/~zge/kaomoji]]           | https://git.sr.ht/~pkal/insert-kaomoji |
